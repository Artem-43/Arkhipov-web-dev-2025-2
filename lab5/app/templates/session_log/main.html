{% extends 'base.html' %}
{% import 'session_log/macros.html' as macros %}

{% block content %}
<h1>Журнал посещений</h1>

<div class="mb-3">
    <a href="{{ url_for('session_log.report_pages') }}" class="btn btn-primary">Отчёт по страницам</a>
    <a href="{{ url_for('session_log.report_users') }}" class="btn btn-primary">Отчёт по пользователям</a>
</div>

<table class="table">
    <thead>
        <tr>
            <th>№</th>
            <th>Дата</th>
            <th>Путь</th>
            {% if current_user.role == 'admin' %}
            <th>Пользователь</th>
            {% endif %}
        </tr>
    </thead>
    <tbody>
        {% for log in logs %}
            {{ macros.visit_log_row(log, loop.index, show_user=(current_user.role == 'admin')) }}
        {% endfor %}
    </tbody>
</table>

<nav>
  <ul class="pagination">
    {% for p in range(1, (total // per_page) + 2) %}
    <li class="page-item {% if p == page %}active{% endif %}">
      <a class="page-link" href="{{ url_for('session_log.main', page=p) }}">{{ p }}</a>
    </li>
    {% endfor %}
  </ul>
</nav>
{% endblock %}
